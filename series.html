<!DOCTYPE html>

<head>
   <meta charset="UTF-8">
   <title>Visualização Ocorrências Policiais</title>
   <script src="libs/d3.min.js"></script>
   <!--Include Leaflet CSS-->
   <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"
      integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A=="
      crossorigin="" />
   <style>
      #mapid {
         height: 90%;
         position: absolute;
         width: 80%;
      }

      #menu {
         float: right;
      }

      .label_menu {
         text-align: center;
      }
   </style>
</head>
<div id="container">

   <body>
      <h2>Roubos de smartphones</h2>
      <a href="index.html">Mapa</a><a> | </a><a href="series.html">Série temporal</a>
      <script>
         //Requesting data from the server

         function loadData() {
            var xhttp = new XMLHttpRequest();
            xhttp.onreadystatechange = function () {
               if (this.readyState == 4 && this.status == 200) {
                  /* document.getElementById("demo").innerHTML =
                      this.responseText;*/
                  var arrMarker = JSON.parse(this.responseText);
                  addMarker(arrMarker);
               }
            };
            var month = document.getElementById('ini_month').value
            var brand = document.getElementById('brand').value
            xhttp.open("GET", "http://api.crimevis.work/getoccur?ini_month=" + month + "&brand=" + brand + "", true);
            xhttp.send();
         }

         //Adding markers
         function addMarker(insMarker) {
            var i;
            for (i = 0; i < insMarker.length; i++) {
               var lat = insMarker[i].latitude;
               var lng = insMarker[i].longitude;
               var marca_celular = insMarker[i].marca_celular;
               var rubrica = insMarker[i].rubrica;
               if (marca_celular == "APPLE") {
                  var marker = L.circleMarker([lat, lng], { color: '#ff0000' }).addTo(mymap);
                  marker.bindPopup("<b>Marca Celular: " + marca_celular + "</b><br>" + rubrica + "").openPopup();
               } else {
                  var marker = L.circleMarker([lat, lng], { color: '#006600' }).addTo(mymap);
                  marker.bindPopup("<b>Marca Celular: " + marca_celular + "</b><br>" + rubrica + "").openPopup();
               }
            }
            /*var lat = insMarker[0].latitude;
            var lng = insMarker[0].longitude;
            var marker = L.marker([lat, lng]).addTo(mymap);
            */
         }
      </script>
      <!--<script type="text/javascript">
         d3.select("body").append("p").text("Hello World");
      </script>-->
      <!-- Make sure you put this AFTER Leaflet's CSS -->
      <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"
         integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA=="
         crossorigin=""></script>
      <div id="menu">
         <h4 class="label_menu">Menu</h4>
         <form action="#">
            <fieldset>
               <label for="mes_inicio">Mês :</label>
               <select name="ini_month" id="ini_month">
                  <option value="Julho">Julho</option>
                  <option value="Agosto">Agosto</option>
                  <option value="Setembro">Setembro</option>
                  <option value="Outubro">Outubro</option>
                  <option value="Novembro">Novembro</option>
                  <option value="Dezembro">Dezembro</option>
               </select>
            </fieldset>
            <fieldset>
               <label for="brand">Modelo:</label>
               <select name="brand" id="brand">
                  <option value="APPLE">APPLE</option>
                  <option value="ANDROID">ANDROID</option>
                  <option value="AMBOS">AMBOS</option>
               </select>
               <input type="button" value="Selecionar" onclick="loadData()">
            </fieldset>
            <br />
            <br />
            <br />
            <br />
            <br />
            <h4 class="label_menu">Descrição</h4>
            <fieldset class="label_menu"><svg width="30" height="30">
                  <circle cx="15" cy="15" r="10" stroke="#aa0000" stroke-width="4" fill="#ff0000" />
               </svg>APPLE</fieldset>
            <fieldset class="label_menu"><svg width="30" height="30">
                  <circle cx="15" cy="15" r="10" stroke="#003300" stroke-width="4" fill="#006600" />
               </svg>ANDROID</fieldset>
            <br />
            <br />
            <br />
            <h4 class="label_menu">Série Temporal</h4>
            <fieldset class="label_menu"><a
                  href="https://public.tableau.com/profile/irvin.bezerra#!/vizhome/Ocorrncias_16160398327900/Painel1?publish=yes">Série
                  temporal das ocorrências</a></fieldset>
         </form>
      </div>
      <div class='tableauPlaceholder' id='viz1616726358190' style='position: relative'><noscript><a href='#'><img
                  alt='Painel 1 '
                  src='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;Oc&#47;Ocorrncias_16160398327900&#47;Painel1&#47;1_rss.png'
                  style='border: none' /></a></noscript><object class='tableauViz' style='display:none;'>
            <param name='host_url' value='https%3A%2F%2Fpublic.tableau.com%2F' />
            <param name='embed_code_version' value='3' />
            <param name='site_root' value='' />
            <param name='name' value='Ocorrncias_16160398327900&#47;Painel1' />
            <param name='tabs' value='no' />
            <param name='toolbar' value='yes' />
            <param name='static_image'
               value='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;Oc&#47;Ocorrncias_16160398327900&#47;Painel1&#47;1.png' />
            <param name='animate_transition' value='yes' />
            <param name='display_static_image' value='yes' />
            <param name='display_spinner' value='yes' />
            <param name='display_overlay' value='yes' />
            <param name='display_count' value='yes' />
            <param name='language' value='pt' />
            <param name='filter' value='publish=yes' />
         </object></div>
      <script
         type='text/javascript'>                    var divElement = document.getElementById('viz1616726358190'); var vizElement = divElement.getElementsByTagName('object')[0]; if (divElement.offsetWidth > 800) { vizElement.style.minWidth = '420px'; vizElement.style.maxWidth = '650px'; vizElement.style.width = '100%'; vizElement.style.minHeight = '587px'; vizElement.style.maxHeight = '887px'; vizElement.style.height = (divElement.offsetWidth * 0.75) + 'px'; } else if (divElement.offsetWidth > 500) { vizElement.style.minWidth = '420px'; vizElement.style.maxWidth = '650px'; vizElement.style.width = '100%'; vizElement.style.minHeight = '587px'; vizElement.style.maxHeight = '887px'; vizElement.style.height = (divElement.offsetWidth * 0.75) + 'px'; } else { vizElement.style.width = '100%'; vizElement.style.height = '727px'; } var scriptElement = document.createElement('script'); scriptElement.src = 'https://public.tableau.com/javascripts/api/viz_v1.js'; vizElement.parentNode.insertBefore(scriptElement, vizElement);</script>
      <!--<div id="mapid"></div>
      <script>
         var mymap = L.map('mapid').setView([-23.5797, -46.6236], 12);
         L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
         }).addTo(mymap);
      </script>-->
      <!--<script>
         //addMarker()
      </script>-->
</div>
</body>

</html>